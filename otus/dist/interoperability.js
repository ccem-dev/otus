!function(){"use strict";angular.module("otusjs.otus.interoperability",["otusjs.otus.interoperability.core","otusjs.otus.interoperability.dataSource","otusjs.otus.interoperability.rest","otusjs.otus.interoperability.storage"])}(),function(){"use strict";angular.module("otusjs.otus.interoperability.core",[])}(),function(){"use strict";function t(){function t(){return s=new Object,s.success=e,s.error=i,s.onResponse=o,s}function e(t){return s.fireSuccessCallback=t,s}function i(t){s.fireErrorCallback=t}function o(t){s.fireOnResponseCallback=t}var r=this,s=null;return r.create=t,r}angular.module("otusjs.otus.interoperability.core").factory("otusjs.otus.interoperability.core.PromiseCallbackHandlerFactory",t)}(),function(){"use strict";function t(t,e,i,o,r){function s(){return f=t.defer(),a(),c(),f.promise}function n(){return{getData:function(){return o.getCollection()},save:function(){o.save(),l()}}}function u(){return{getData:function(){return r.getCollection()},save:function(){r.save()}}}function a(){e.initialize(),i.initialize()}function c(){i.list().then(function(t){t.data&&t.data.length?(r.getCollection().clear(),r.getCollection().insert(t.data),r.save()):console.log("Não foi possível atualizar o storage local."),v=!0,v&&g&&f.resolve()}),e.list().then(function(t){t.data&&t.data.length?(o.getCollection().clear(),o.getCollection().insert(t.data),o.save(),console.log("Storage local de atividades atualizado com dados do servidor.")):console.log("Não foi possível atualizar o storage local."),g=!0,v&&g&&f.resolve()})}function l(){var t=o.getCollection().find();e.update(t).then(function(t){console.log("Dados de atividade sincronizados.")})["catch"](function(t){console.log("Falha ao sincronizar dados de atividade.")})}var p=this,f=null,v=!1,g=!1;p.up=s,p.getActivityDataSet=n,p.getSurveyDataSet=u}angular.module("otusjs.otus.interoperability.dataSource").service("otusjs.otus.interoperability.dataSource.ActivityDataSourceService",t),t.$inject=["$q","otusjs.otus.interoperability.rest.otusApi.ActivityRepositoryService","otusjs.otus.interoperability.rest.otusApi.SurveyRepositoryService","otusjs.activity.storage.ActivityStorageService","otusjs.activity.storage.SurveyStorageService"]}(),function(){"use strict";function t(t,i,o,r,s,n,u){e(t).then(function(t){s.connectTo(r),o.connectTo(i),u.connectTo(n)})}function e(t){return t.initialize()}angular.module("otusjs.otus.interoperability.dataSource",[]).run(t),t.$inject=["otusjs.otus.interoperability.storage.StorageService","otusjs.otus.interoperability.dataSource.UserDataSourceService","otusjs.user.access.service.UserCollectionService","otusjs.otus.interoperability.dataSource.ParticipantDataSourceService","otusjs.participant.repository.ParticipantRepositoryService","otusjs.otus.interoperability.dataSource.ActivityDataSourceService","otusjs.activity.repository.ActivityRepositoryService"],e.$inject=["otusjs.otus.interoperability.storage.StorageService"]}(),function(){"use strict";function t(t,e,i){function o(){return a=t.defer(),s(),n(),a.promise}function r(){return i.getCollection().find()}function s(){e.initialize()}function n(){e.listIdexers().success(function(t){i.getCollection().clear(),i.getCollection().insert(t),i.save(),a.resolve()})}var u=this,a=null;u.up=o,u.listIndexers=r}angular.module("otusjs.otus.interoperability.dataSource").service("otusjs.otus.interoperability.dataSource.ParticipantDataSourceService",t),t.$inject=["$q","otusjs.otus.interoperability.rest.otusApi.ParticipantRepositoryService","otusjs.otus.interoperability.storage.ParticipantStorageService"]}(),function(){"use strict";function t(t,e,i,o){function r(){return c=t.defer(),s(),n(),c.promise}function s(){e.initialize()}function n(){c.resolve()}function u(t){return o.authenticate(t)}var a=this,c=null;a.up=r,a.authenticateUserData=u}angular.module("otusjs.otus.interoperability.dataSource").service("otusjs.otus.interoperability.dataSource.UserDataSourceService",t),t.$inject=["$q","otusjs.otus.interoperability.rest.otusApi.UserRepositoryService","otusjs.user.storage.UserStorageService","otusjs.otus.interoperability.rest.otusApi.LoginProxyService"]}(),function(){"use strict";angular.module("otusjs.otus.interoperability.rest",["otusjs.otus.interoperability.rest.otusApi"])}(),function(){"use strict";angular.module("otusjs.otus.interoperability.storage",["lokijs"])}(),function(){"use strict";function t(t,e,i){function o(){return l=t.defer(),e.initialize().then(s),i.initialize().then(n),l.promise}function r(){return c}function s(){c=e.isReady()&&i.isReady(),u()}function n(){c=e.isReady()&&i.isReady(),u()}function u(){r()&&l.resolve("Application start data loaded.")}var a=this,c=!1,l=null;a.local=e,a.session=i,a.initialize=o,a.isReady=r}angular.module("otusjs.otus.interoperability.storage").service("otusjs.otus.interoperability.storage.StorageService",t),t.$inject=["$q","otusjs.otus.interoperability.storage.LocalStorageService","otusjs.otus.interoperability.storage.SessionStorageService"]}(),function(){"use strict";function t(t,e){function i(){u=t.getActivityResource()}function o(t){return u.update(t).$promise}function r(){return e.get("app/application/data-source/file/activities.json")}function s(t){return u.remove(t).$promise}var n=this,u=null;n.initialize=i,n.update=o,n.list=r,n.remove=s}angular.module("otusjs.otus.interoperability.rest.otusApi").service("otusjs.otus.interoperability.rest.otusApi.ActivityRepositoryService",t),t.$inject=["OtusRestResourceService","$http"]}(),function(){"use strict";function t(t){function e(e){t.getOtusInstallerResource().ready(e)}var i=this;i.ready=e}angular.module("otusjs.otus.interoperability.rest.otusApi").service("otusjs.otus.interoperability.rest.otusApi.InstallerProxyService",t),t.$inject=["OtusRestResourceService"]}(),function(){"use strict";function t(t,e){function i(){return s}function o(t){var i=e.getOtusAuthenticatorResource();return i.authenticate(t).$promise}var r=this,s=(t.create(),{});r.getResponse=i,r.authenticate=o}angular.module("otusjs.otus.interoperability.rest.otusApi").service("otusjs.otus.interoperability.rest.otusApi.LoginProxyService",t),t.$inject=["otusjs.otus.interoperability.core.PromiseCallbackHandlerFactory","OtusRestResourceService"]}(),function(){"use strict";function t(t,e){function i(){return _response}function o(){var t=e.getOtusAuthenticatorResource(),i=t.invalidate().$promise;return i.then(r,s),u}function r(t){u.fireOnResponseCallback(t),t.hasErrors?u.fireErrorCallback():u.fireSuccessCallback()}function s(){console.error("Transaction error")}var n=this,u=t.create();n.getResponse=i,n.invalidate=o}angular.module("otusjs.otus.interoperability.rest.otusApi").service("otusjs.deploy.AuthenticationRestService",t),t.$inject=["otusjs.otus.interoperability.core.PromiseCallbackHandlerFactory","OtusRestResourceService"]}(),function(){"use strict";angular.module("otusjs.otus.interoperability.rest.otusApi",[])}(),function(){"use strict";function t(t,e,i){function o(){n=t.create()}function r(){return i.get("app/application/data-source/file/participants_dummy.json")}var s=this,n=null;s.initialize=o,s.listIdexers=r}angular.module("otusjs.otus.interoperability.rest.otusApi").service("otusjs.otus.interoperability.rest.otusApi.ParticipantRepositoryService",t),t.$inject=["otusjs.otus.interoperability.core.PromiseCallbackHandlerFactory","OtusRestResourceService","$http"]}(),function(){"use strict";function t(t,e){function i(){s=t.getSurveyResource()}function o(){return e.get("app/application/data-source/file/surveys.json")}var r=this,s=null;r.initialize=i,r.list=o}angular.module("otusjs.otus.interoperability.rest.otusApi").service("otusjs.otus.interoperability.rest.otusApi.SurveyRepositoryService",t),t.$inject=["OtusRestResourceService","$http"]}(),function(){"use strict";function t(t,e,i){function o(){s=t.create()}var r=this,s=null;r.initialize=o}angular.module("otusjs.otus.interoperability.rest.otusApi").service("otusjs.otus.interoperability.rest.otusApi.UserRepositoryService",t),t.$inject=["otusjs.otus.interoperability.core.PromiseCallbackHandlerFactory","OtusRestResourceService","$http"]}(),function(){"use strict";function t(t,e){function i(){return u}function o(){return r(e.isLogged()),n}function r(t){n.fireOnResponseCallback(t),t.hasErrors?n.fireErrorCallback():(e.setSecurityToken(t.data.token),n.fireSuccessCallback())}var s=this,n=t.create(),u={};s.getResponse=i,s.isLogged=o}angular.module("otusjs.otus.interoperability.rest.otusApi").service("otusjs.otus.interoperability.rest.otusApi.UserSessionProxyService",t),t.$inject=["otusjs.otus.interoperability.core.PromiseCallbackHandlerFactory","OtusRestResourceService"]}(),function(){"use strict";function t(t){function e(){f=t.createInstance({name:"otus",driver:"asyncStorage",storeName:"session_data"})._localforage,i("dbname","otus")}function i(t,e){return f.setItem(t,e)}function o(t){return f.getItem(t)}function r(t){return f.removeItem(t)}function s(t){return f.pull(t)}function n(){return f.clear()}function u(t){return f.key(t)}function a(){return f.keys()}function c(){return f.length()}function l(t){return f.iterate(t)}var p=this,f=null;p.initialize=e,p.setItem=i,p.getItem=o,p.removeItem=r,p.pull=s,p.clear=n,p.key=u,p.keys=a,p.length=c,p.iterate=l}angular.module("otusjs.otus.interoperability.storage").service("otusjs.otus.interoperability.storage.IndexedDbService",t),t.$inject=["$localForage"]}(),function(){"use strict";function t(){function t(t,e){r=t,s=e}function e(){return r}function i(){s.saveDatabase()}var o=this,r={},s=null;o.initialize=t,o.getCollection=e,o.save=i}angular.module("otusjs.otus.interoperability.storage").service("otusjs.activity.storage.ActivityStorageService",t)}(),function(){"use strict";function t(t,e,i,o,r,s){function n(){return v=t.defer(),p=new loki("otusdb",{autoload:!0,autoloadCallback:c}),v.promise}function u(){return f}function a(){return p}function c(){p.getCollection("system")?(o.initialize(p.getCollection("users"),p),i.initialize(p.getCollection("participants"),p),r.initialize(p.getCollection("surveys"),p),s.initialize(p.getCollection("activities"),p)):(p.addCollection("system"),o.initialize(p.addCollection("users"),p),i.initialize(p.addCollection("participants"),p),r.initialize(p.addCollection("surveys"),p),s.initialize(p.addCollection("activities"),p)),p.saveDatabase(),f=!0,v.resolve()}var l=this,p=null,f=!1,v=null;l.initialize=n,l.isReady=u,l.getOtusDb=a}angular.module("otusjs.otus.interoperability.storage").service("otusjs.otus.interoperability.storage.LocalStorageService",t),t.$inject=["$q","Lokiwork","otusjs.otus.interoperability.storage.ParticipantStorageService","otusjs.user.storage.UserStorageService","otusjs.activity.storage.SurveyStorageService","otusjs.activity.storage.ActivityStorageService"]}(),function(){"use strict";function t(){function t(t,e){r=t,s=e}function e(){return r}function i(){s.saveDatabase()}var o=this,r={},s=null;o.initialize=t,o.getCollection=e,o.save=i}angular.module("otusjs.otus.interoperability.storage").service("otusjs.otus.interoperability.storage.ParticipantStorageService",t)}(),function(){"use strict";function t(){function t(t,e){r=t,s=e}function e(){return r}function i(){s.saveDatabase()}var o=this,r={},s=null;o.initialize=t,o.getCollection=e,o.save=i}angular.module("otusjs.otus.interoperability.storage").service("otusjs.activity.storage.SurveyStorageService",t)}(),function(){"use strict";function t(){function t(t,e){r=t,s=e}function e(){return r}function i(){s.saveDatabase()}var o=this,r={},s=null;o.initialize=t,o.getCollection=e,o.save=i}angular.module("otusjs.otus.interoperability.storage").service("otusjs.user.storage.UserStorageService",t)}(),function(){"use strict";function t(t,e){function i(){return g=t.defer(),f=e.sessionStorage,v=!0,g.resolve(),g.promise}function o(){return v}function r(t,e){return f.setItem(t,e)}function s(t){return f.getItem(t)}function n(t){return f.removeItem(t)}function u(){return f.clear()}function a(t){return f.key(t)}function c(){return f.keys()}function l(){return f.length()}var p=this,f=null,v=!1,g=null;p.initialize=i,p.isReady=o,p.setItem=r,p.getItem=s,p.removeItem=n,p.clear=u,p.key=a,p.keys=c,p.length=l}angular.module("otusjs.otus.interoperability.storage").service("otusjs.otus.interoperability.storage.SessionStorageService",t),t.$inject=["$q","$window"]}();