!function(){"use strict";angular.module("otusjs.activity",["otusjs.activity.core","otusjs.otus.uxComponent"])}(),function(){"use strict";angular.module("otusjs.otus.uxComponent",[])}(),function(){"use strict";function t(t,i){function e(){l(),A()}function n(){l(),c()}function c(){if(!I)throw new Error("StorageService (session) is not initialized.");E.context=JSON.parse(I.getItem(i.ACTIVITY_CONTEXT))}function o(){I&&I.removeItem(i.ACTIVITY_CONTEXT),E=null}function a(){return!!I&&!!I.getItem(i.ACTIVITY_CONTEXT)}function r(t){I=t}function s(){return E}function u(t){D=t,D.activityContextService=C}function l(){if(E=D.getScope().$new()||null,!E)throw new Error("Internal application $scope was not correctly initialized.");E.name=i.ACTIVITY_CONTEXT,E.context={}}function v(t,i){E&&E.$broadcast(t,i)}function p(t,i){E?E.$on(t,i):f(t,i)}function d(t){return E&&E.context?E.context[t]:null}function m(t,i){E&&E.context&&(E.context[t]=i,A())}function y(t){E&&(delete E.context[t],A())}function A(){if(!I)throw new Error("StorageService (session) is not initialized.");if(!E)throw new Error("Internal $scope is not initialized.");I.setItem(i.ACTIVITY_CONTEXT,JSON.stringify(E.context))}function f(t,i){var e={};e.name=t,e.callback=i,h.push(e)}function g(){return D.participantContextService?D.participantContextService.getSelectedParticipant():null}function S(){return d("selectedActivities")}function T(){m("selectedActivities",[])}function j(i){m("selectedActivities",i),v(t.ACTIVITY_SELECTED,i)}var C=this,I=null,D=null,E=null,h=[];C.EVENTS=t,C.CONTEXT_DATA=i,C.begin=e,C.restore=n,C.end=o,C.isValid=a,C.configureStorage=r,C.getScope=s,C.broadcast=v,C.getData=d,C.setData=m,C.removeData=y,C.onEvent=p,C.save=A,C.setParent=u,C.selectActivities=j,C.getSelectedParticipant=g,C.getSelectedActivities=S,C.clearSelectedActivities=T}angular.module("otusjs.activity").service("otusjs.activity.core.ContextService",t),t.$inject=["EVENTS","CONTEXT_DATA"]}(),function(){"use strict";angular.module("otusjs.activity.core",["otusjs.activity.business"]).constant("EVENTS",{ACTIVITY_SELECTED:"activity.selected"})}(),function(){"use strict";function t(t){function i(){return n}function e(t){t.isValid()?t.restore():t.begin()}var n=this;n.$get=[i],n.state={parent:t.DASHBOARD,name:t.ACTIVITY_ADDER,url:"/"+t.ACTIVITY_ADDER,template:'<otus-activity-adder layout="column" flex></otus-activity-adder>',onEnter:e},e.$inject=["otusjs.activity.core.ContextService"]}angular.module("otusjs.otus.application.state").provider("otusjs.otus.application.state.ActivityAdderState",t),t.$inject=["STATE"]}(),function(){"use strict";function t(t){function i(){return n}function e(t){t.isValid()?t.restore():t.begin()}var n=this;n.$get=[i],n.state={parent:t.DASHBOARD,name:t.PARTICIPANT_ACTIVITY,url:"/"+t.PARTICIPANT_ACTIVITY,template:'<otus-activity-manager layout="column" flex></otus-activity-manager>',onEnter:e},e.$inject=["otusjs.activity.core.ContextService"]}angular.module("otusjs.otus.application.state").provider("otusjs.otus.application.state.ActivityState",t),t.$inject=["STATE"]}(),function(){"use strict";function t(t,i){function e(){t.add(o),o=[],i.activateParticipantActivities()}function n(t){var i=o.indexOf(t);i!==-1?o.splice(i,1):o.push(t)}var c=this,o=[];c.addActivities=e,c.catchActivity=n}angular.module("otusjs.otus.uxComponent").component("otusActivityAdder",{controller:t,templateUrl:"app/module/activity/component/activity-adder/activity-adder-template.html"}),t.$inject=["otusjs.activity.business.ParticipantActivityManagementService","otusjs.application.state.ApplicationStateService"]}(),function(){"use strict";function t(t){function i(){e()}function e(){c.activities=t.listAvailables()}function n(t){c.onActivitySelection({activity:t})}var c=this;c.activities=[],c.selectActivity=n,c.$onInit=i}angular.module("otusjs.otus.uxComponent").component("otusActivityAdderList",{controller:t,templateUrl:"app/module/activity/component/activity-adder-list/activity-adder-list-template.html",bindings:{onActivitySelection:"&"}}),t.$inject=["otusjs.activity.business.ParticipantActivityManagementService"]}(),function(){"use strict";function t(t){function i(){n.onAddActivities()}function e(){t.activateParticipantActivities()}var n=this;n.addActivities=i,n.returnToParticipantActivities=e}angular.module("otusjs.otus.uxComponent").component("otusActivityAdderToolbar",{controller:t,templateUrl:"app/module/activity/component/activity-adder-toolbar/activity-adder-toolbar-template.html",bindings:{onAddActivities:"&"}}),t.$inject=["otusjs.application.state.ApplicationStateService"]}(),function(){"use strict";function t(){function t(){e.listComponent.update()}function i(){e.toolbarComponent={},e.listComponent={}}var e=this;e.handleDeleteAction=t,e.$onInit=i}angular.module("otusjs.otus.uxComponent").component("otusActivityManager",{controller:t,templateUrl:"app/module/activity/component/activity-manager/activity-manager-template.html"})}(),function(){"use strict";function t(t){function i(){t.activateActivityAdder()}var e=this;e.goToActivityAdder=i}angular.module("otusjs.otus.uxComponent").component("otusActivityManagerCommander",{controller:t,templateUrl:"app/module/activity/component/activity-manager-commander/activity-manager-commander-template.html"}),t.$inject=["otusjs.application.state.ApplicationStateService"]}(),function(){"use strict";function t(t,i){function e(t){var e=r.indexOf(t);e>-1?(r.splice(e,1),t.isSelected=!1):(r.push(t),t.isSelected=!0),i.selectActivities(r)}function n(){r=[],o()}function c(){a.otusActivityManager.listComponent=a,o(),t.onEvent("$siblings.participant.selected",o)}function o(){a.activities=i.listAll()}var a=this,r=[];a.activities=[],a.selectActivity=e,a.update=n,a.$onInit=c}angular.module("otusjs.otus.uxComponent").component("otusActivityList",{controller:t,templateUrl:"app/module/activity/component/activity-manager-list/activity-manager-list-template.html",require:{otusActivityManager:"^otusActivityManager"}}),t.$inject=["otusjs.activity.core.ContextService","otusjs.activity.business.ParticipantActivityManagementService"]}(),function(){"use strict";function t(t,i){function e(){i.getSelectedActivities().remove(),o.onDelete()}function n(){c(),o.otusActivityManager.toolbarComponent=o,t.onEvent("$siblings.participant.selected",c)}function c(){o.selectedParticipant=i.getSelectedParticipant()}var o=this;o.deleteSelectedActivity=e,o.$onInit=n}angular.module("otusjs.otus.uxComponent").component("otusActivityManagerToolbar",{controller:t,templateUrl:"app/module/activity/component/activity-manager-toolbar/activity-manager-toolbar-template.html",require:{otusActivityManager:"^otusActivityManager"},bindings:{onDelete:"&"}}),t.$inject=["otusjs.activity.core.ContextService","otusjs.activity.business.ParticipantActivityManagementService"]}(),function(){"use strict";function t(t){function i(t){s=t,s.up().then(a)}function e(i){i=i.map(function(i){var e=t.getSelectedParticipant(),n={};return n.acronym=i.acronym,n.name=i.name,n.surveyID=i.surveyID,n.participantData={},n.participantData.recruitmentNumber=e.recruitmentNumber,n.participantData.name=e.name,n.participantData.fieldCenter=e.fieldCenter,n}),i.length&&(s.getActivityDataSet().getData().insert(i),s.getActivityDataSet().save())}function n(){var i=t.getSelectedParticipant(),e=s.getActivityDataSet().getData().where(function(t){return t.participantData.recruitmentNumber===i.recruitmentNumber});return e}function c(){return s.getSurveyDataSet().getData().find()}function o(t){t.forEach(function(t){s.getActivityDataSet().getData().remove(t)}),s.getActivityDataSet().save()}function a(t){console.debug("ActivityCollectionService initialized.")}var r=this,s=null;r.connectTo=i,r.add=e,r.listAll=n,r.listAvailables=c,r.remove=o}angular.module("otusjs.activity.business").service("otusjs.activity.repository.ActivityRepositoryService",t),t.$inject=["otusjs.activity.core.ContextService"]}(),function(){"use strict";angular.module("otusjs.activity.business",[])}(),function(){"use strict";function t(t,i){function e(t){return i.add(t)}function n(){return i.listAll()}function c(){return i.listAvailables()}function o(i){t.selectActivities(i)}function a(){return{list:function(){return t.getSelectedActivities()},remove:function(){i.remove(t.getSelectedActivities()),t.clearSelectedActivities()}}}function r(){return t.getSelectedParticipant()}var s=this;s.add=e,s.listAll=n,s.listAvailables=c,s.selectActivities=o,s.getSelectedActivities=a,s.getSelectedParticipant=r}angular.module("otusjs.activity.business").service("otusjs.activity.business.ParticipantActivityManagementService",t),t.$inject=["otusjs.activity.core.ContextService","otusjs.activity.repository.ActivityRepositoryService"]}(),function(){"use strict";angular.module("otusjs.activity.study",[])}();