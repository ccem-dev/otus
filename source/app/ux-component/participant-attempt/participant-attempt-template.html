<div
  ng-if="$ctrl.addresses.length > 0"
  layout="column"
  class="layout-margin layout-padding"
  style="width: 832px; max-width: calc(100% - 2px); margin: 0 auto;"
  layout-fill=""
  flex
>
  <div class="md-whiteframe-z1" style="background: white; padding: 10px">
    <span class="md-subhead">Registrar tentativa de contato</span>

    <div layout="row" layout-align="center center" style="margin-top: 8px">
      <md-input-container flex="" layout-fill="">
        <md-select ng-model="$ctrl.selectedAddress" ng-change='$ctrl.getAttempts()' aria-label="address">
          <md-option ng-value="address"
                     ng-repeat="address in $ctrl.addresses track by $index"
                     ng-selected="$index === 0">
            {{address.census && address.census + " - "}}{{address.street}}{{address.streetNumber && ", " + address.streetNumber}}{{" - " + address.city + ", " + address.state + " (" + address.country + ")"}}
          </md-option>
        </md-select>
      </md-input-container>
    </div>

    <div layout="row" layout-xs="column" layout-align="space-between center">
      <div flex="100" layout="row" layout-xs="column">
        <div layout="row" layout-align="center center" style="margin-right: 16px">
          <span class="md-subheader">Status: </span>
          <md-input-container flex="">
            <md-select ng-model="$ctrl.selectedStatus" aria-label="address">
              <md-option ng-value="status"
                         ng-repeat="status in $ctrl.addressConfiguration.statusMetadata track by $index"
                         ng-selected="$index == 0">
                {{status.value}}
              </md-option>
            </md-select>
          </md-input-container>
        </div>

        <span flex="5"></span>

        <div layout="row" layout-align="center center" style="margin-bottom: 16px">
          <md-input-container class="md-input-has-placeholder md-input-has-value"
                              style="position: relative; top: 20px;margin-left: 5px;"
                              ng-style="{'margin':'0 auto'}">
            <label class="md-subheader"></label>
            <input placeholder="data/hora" mdc-datetime-picker=""
                   show-icon="true" date="true" time="true" aria-label="attemptDatetime"
                   type="text" id="datetime" show-todays-date=""
                   max-date="$ctrl.now" ng-model="$ctrl.attemptDate"
                   class="md-input" readonly="readonly" short-time="true" format="DD/MM/YYYY HH:mm A"
                   disable-parent-scroll="true">
          </md-input-container>
        </div>
      </div>

      <md-button ng-click="$ctrl.save()" ng-disabled="!$ctrl.attemptDate || !$ctrl.selectedStatus" class="md-raised md-primary" style="margin-left: auto">
        registrar
      </md-button>
    </div>

    <md-divider style="margin-left: auto; margin-right: auto; margin-top: 16px; margin-bottom: 16px" />

    <div>
      <span ng-if="$ctrl.attempts.length > 0" class="md-subhead">Visualizar tentativas de contato</span>
      <md-list ng-if="$ctrl.attempts.length > 0">
        <md-list-item class="md-whiteframe-z1" style="background: white;" layout-fill=""
                      ng-repeat="attempt in $ctrl.attempts track by $index">
          <div class="md-list-item-text" layout-fill="" layout="row" layout-align="space-between center" layout-align-xs="center center">
            <span
              hide-gt-xs
              ng-style="{
                backgroundColor: '{{attempt.attemptStatus.statusColor}}',
                height: '10px',
                width: '10px',
                padding: '10px',
                borderRadius: '50%',
                textAlign: 'center'
              }"
            ></span>
            <span hide-gt-xs flex="5"></span>
            <div layout="column">
              <span ng-style="{textAlign: 'center'}">
                {{$ctrl.parseToDateWithTime(attempt.attemptDateTime)}}
              </span>
            </div>
            <span flex="5"></span>
            <div layout="column">
              <span ng-style="{textAlign: 'justify'}">
              {{attempt.address[$ctrl.selectedAddress.pos].value.street}}, {{attempt.address[$ctrl.selectedAddress.pos].value.streetNumber}}
              </span>
            </div>
            <span hide-xs flex="5"></span>
            <span hide-xs ng-style="{backgroundColor: '{{attempt.attemptStatus.statusColor}}',
                             padding: '10px',
                             width: '100px',
                             textAlign: 'center'}">
              {{attempt.attemptStatus.value}}
            </span>
            <span flex="5"></span>
            <md-button ng-click="$ctrl.remove(attempt._id)" class="md-icon-button">
              <md-icon style="color: #d50000">
                delete_forever
              </md-icon>
            </md-button>
          </div>
        </md-list-item>
      </md-list>
      <div ng-if="$ctrl.attempts.length < 1" layout="row" layout-align="center center">
        <span class="md-subhead">
          Não há tentativas de contato para este endereço
        </span>
      </div>
    </div>
  </div>
</div>